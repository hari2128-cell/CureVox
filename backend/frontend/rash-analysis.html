<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CureVox AI - Rash Analysis | Enterprise Dermatology AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
    <style>
        /* WORLD-CLASS - UI IDENTICAL TO DASHBOARD */
        *{margin:0;padding:0;box-sizing:border-box}
        html { scroll-behavior: smooth; overflow-x: hidden; }
        body{
            font-family:'Inter',sans-serif;
            background:linear-gradient(135deg,#0f0f23 0%,#1a1a2e 50%,#16213e 100%);
            color:white;min-height:100vh;position:relative;overflow-x:hidden;line-height:1.6;
        }
        
        /* ENTERPRISE BACKGROUND */
        .bg-animation{
            position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;
            background: 
                radial-gradient(circle at 20% 80%,rgba(245,158,11,0.25) 0%,transparent 50%),
                radial-gradient(circle at 80% 20%,rgba(245,158,11,0.15) 0%,transparent 50%),
                radial-gradient(circle at 50% 50%,rgba(102,126,234,0.1) 0%,transparent 70%);
            animation:float 20s ease-in-out infinite;
        }
        @keyframes float{
            0%,100%{transform:translateY(0px) rotate(0deg)}
            33%{transform:translateY(-15px) rotate(0.5deg)}
            66%{transform:translateY(-10px) rotate(-0.5deg)}
        }

        /* ENTERPRISE SIDEBAR (MATCHES DASHBOARD) */
        .sidebar {
            position: fixed; left: 0; top: 0; height: 100vh; width: 280px;
            background: linear-gradient(180deg, #16213e 0%, #0f141f 100%);
            z-index: 1000; padding: 20px 0; border-right: 2px solid #334155;
            transition: all 0.3s ease;
        }
        .nav-logo { padding: 0 25px 30px; text-align: center; border-bottom: 1px solid #334155; margin-bottom: 30px; }
        .logo { font-size: 24px; font-weight: 700; color: #f59e0b; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .nav-menu { list-style: none; padding: 0 20px; }
        .nav-item { margin-bottom: 12px; }
        .nav-link { 
            display: flex; align-items: center; gap: 15px; padding: 18px 20px;
            color: #94a3b8; text-decoration: none; border-radius: 12px; font-weight: 500; font-size: 15px;
            transition: all 0.3s ease;
        }
        .nav-link:hover { 
            background: rgba(245, 158, 11, 0.25); color: #f59e0b; transform: translateX(8px);
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.2);
        }
        .nav-icon { font-size: 20px; width: 24px; flex-shrink: 0; }

        .main-container { margin-left: 280px; min-height: 100vh; transition: all 0.3s ease; }
        .main { max-width: 1200px; margin: 0 auto; padding: 40px 30px 50px; position: relative; }

        /* ENTERPRISE HEADER */
        .header {
            background: rgba(22, 33, 62, 0.95); backdrop-filter: blur(30px);
            padding: 25px 35px; border-radius: 24px; margin-bottom: 40px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);
        }
        .header-left { display: flex; align-items: center; gap: 25px; }
        .mobile-menu-btn { display: none; background: none; border: none; color: white; font-size: 24px; cursor: pointer; padding: 10px; border-radius: 12px; }
        .page-title { font-size: 28px; font-weight: 700; color: #f59e0b; display: flex; align-items: center; gap: 12px; }
        .user-section { display: flex; align-items: center; gap: 20px; }
        .profile-container { display: flex; align-items: center; gap: 15px; cursor: pointer; padding: 12px 20px; background: rgba(255,255,255,0.08); border-radius: 16px; border: 1px solid rgba(255,255,255,0.1); transition: all 0.3s; }
        .profile-container:hover { background: rgba(245,158,11,0.15); }
        .user-avatar { width: 50px; height: 50px; border-radius: 50%; background: linear-gradient(135deg, #667eea, #764ba2); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 18px; }
        .user-info { text-align: right; min-width: 140px; }
        .user-name { font-weight: 600; margin-bottom: 4px; font-size: 16px; }
        .user-role { background: linear-gradient(135deg, #f59e0b, #d97706); color: white; padding: 4px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .logout-btn { background: rgba(239,68,68,0.2); border: 1px solid rgba(239,68,68,0.3); color: white; padding: 12px 24px; border-radius: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px; }
        .logout-btn:hover { background: #ef4444; transform: translateY(-2px); }

        /* PROGRESS BAR */
        .progress-container{margin-bottom:3rem}
        .progress-bar{
            background:rgba(255,255,255,0.08);border-radius:50px;height:12px;overflow:hidden;
            border:1px solid rgba(255,255,255,0.15);backdrop-filter:blur(20px);
        }
        .progress-fill{
            background:linear-gradient(90deg,#f59e0b,#d97706);
            height:100%;border-radius:50px;width:50%;animation:progress 2s ease-in-out;
            transition:all 0.5s;box-shadow:0 0 20px rgba(245,158,11,0.4);
        }
        @keyframes progress{0%{width:0%}100%{width:50%}}

        /* ANALYSIS HEADER */
        .analysis-header{text-align:center;margin-bottom:4rem}
        .analysis-title{
            font-size:clamp(2.5rem,6vw,4rem);font-weight:800;
            background:linear-gradient(135deg,#f59e0b,#d97706);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:1rem;
        }
        .analysis-subtitle{
            font-size:1.4rem;color:rgba(255,255,255,0.85);max-width:700px;
            margin:0 auto;line-height:1.7;font-weight:400;
        }
        .accuracy-badge{
            display:inline-flex;align-items:center;gap:8px;background:rgba(245,158,11,0.2);
            color:#f59e0b;padding:10px 20px;border-radius:50px;font-weight:600;font-size:14px;
            border:1px solid rgba(245,158,11,0.3);margin-top:1rem;
        }

        /* CAMERA SECTION */
        .camera-section{
            background:rgba(255,255,255,0.08);backdrop-filter:blur(25px);
            border:1px solid rgba(255,255,255,0.15);border-radius:32px;padding:4rem;
            text-align:center;position:relative;overflow:hidden;box-shadow:0 25px 50px rgba(0,0,0,0.3);
        }
        .camera-section::before{
            content:'';position:absolute;top:0;left:0;right:0;height:5px;
            background:linear-gradient(90deg,#f59e0b,#d97706,transparent,#d97706,#f59e0b);
        }
        .camera-preview{
            width:100%;max-width:500px;height:350px;border-radius:24px;
            border:3px solid rgba(255,255,255,0.2);background:rgba(0,0,0,0.4);
            display:flex;align-items:center;justify-content:center;margin:0 auto 2.5rem;
            font-size:4rem;color:rgba(255,255,255,0.3);position:relative;overflow:hidden;
        }
        .camera-preview.active{
            border-color:#f59e0b;box-shadow:0 0 50px rgba(245,158,11,0.5);
        }
        .camera-controls{display:flex;flex-direction:column;align-items:center;gap:1.5rem}
        .camera-btn{
            display:inline-flex;align-items:center;gap:1rem;background:linear-gradient(135deg,#f59e0b,#d97706);
            color:white;border:none;border-radius:50px;padding:1.8rem 3.5rem;font-size:1.3rem;
            font-weight:700;cursor:pointer;transition:all 0.4s;box-shadow:0 20px 40px rgba(245,158,11,0.4);
        }
        .camera-btn:hover{transform:translateY(-8px);box-shadow:0 30px 60px rgba(245,158,11,0.5)}
        .camera-btn.capture{background:linear-gradient(135deg,#10b981,#059669);box-shadow:0 20px 40px rgba(16,185,129,0.4)}
        .camera-btn.capture:hover{box-shadow:0 30px 60px rgba(16,185,129,0.5)}
        .status-indicator{
            margin-top:1.5rem;font-size:1.2rem;color:rgba(255,255,255,0.85);font-weight:500;
            display:flex;align-items:center;justify-content:center;gap:8px;
        }
        .status-ready{color:#10b981;font-weight:600}

        /* UPLOAD SECTION */
        .upload-section{margin-top:4rem;padding:2.5rem 0;border-top:2px solid rgba(255,255,255,0.08)}
        .upload-zone{
            display:flex;align-items:center;justify-content:center;border:3px dashed rgba(255,255,255,0.25);
            border-radius:28px;padding:3.5rem;cursor:pointer;transition:all 0.4s;
            background:rgba(255,255,255,0.04);backdrop-filter:blur(20px);min-height:140px;
            position:relative;
        }
        .upload-zone:hover{border-color:#f59e0b;background:rgba(245,158,11,0.1);transform:translateY(-6px)}
        .upload-zone.dragover{border-color:#10b981 !important;background:rgba(16,185,129,0.2) !important;transform:scale(1.02)}
        .upload-icon{font-size:4.5rem;color:rgba(255,255,255,0.5);margin-right:2.5rem;flex-shrink:0}
        .upload-text h3{font-size:1.6rem;margin-bottom:0.5rem;font-weight:700}
        .upload-text p{color:rgba(255,255,255,0.65);font-size:1rem}
        .upload-preview{
            position:absolute;top:20px;right:20px;width:120px;height:120px;border-radius:20px;
            background:rgba(0,0,0,0.6);border:3px solid rgba(255,255,255,0.3);object-fit:cover;
            display:none;
        }
        .upload-preview.show{display:block !important}
        .upload-or{text-align:center;margin:2.5rem 0;font-size:1.1rem;color:rgba(255,255,255,0.7);font-weight:500}

        /* GUIDELINES */
        .guidelines{
            margin-top:4rem;display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
            gap:2rem;
        }
        .guideline-item{
            display:flex;align-items:flex-start;gap:1.2rem;padding:2rem;
            background:rgba(255,255,255,0.06);border-radius:24px;border:1px solid rgba(255,255,255,0.1);
            transition:all 0.3s;
        }
        .guideline-item:hover{transform:translateY(-4px);border-color:rgba(245,158,11,0.3)}
        .guideline-icon{
            width:60px;height:60px;border-radius:16px;display:flex;align-items:center;
            justify-content:center;font-size:1.4rem;color:white;flex-shrink:0;font-weight:700;
        }
        .guideline-icon:nth-child(1){background:linear-gradient(135deg,#f59e0b,#d97706)}
        .guideline-icon:nth-child(2){background:linear-gradient(135deg,#10b981,#059669)}
        .guideline-icon:nth-child(3){background:linear-gradient(135deg,#3b82f6,#1d4ed8)}
        .guideline-text h4{font-size:1.2rem;font-weight:700;margin-bottom:0.6rem}
        .guideline-text p{color:rgba(255,255,255,0.8);font-size:1rem;line-height:1.6}

        /* PERFECT RESPONSIVE */
        @media(max-width:1200px){.main-container{margin-left:260px}}
        @media(max-width:992px){
            .sidebar{width:240px;transform:translateX(-100%)}
            .sidebar.mobile-open{transform:translateX(0)}
            .main-container{margin-left:0}
            .mobile-menu-btn{display:block}
            .header{padding:20px 25px;flex-wrap:wrap;gap:15px}
            .upload-zone{flex-direction:column;text-align:center;gap:1.5rem;padding:3rem 2rem}
            .upload-icon{margin-right:0;margin-bottom:1rem;font-size:4rem}
            .guidelines{grid-template-columns:1fr;gap:1.5rem}
        }
        @media(max-width:768px){
            .main{padding:25px 20px 40px}
            .analysis-title{font-size:2.2rem}
            .camera-section{padding:2.5rem 2rem}
            .camera-preview{height:300px;max-width:100%}
            .camera-btn{padding:1.5rem 2.5rem;font-size:1.1rem}
        }
        @media(max-width:480px){
            .main{padding:20px 15px}
            .camera-preview{height:280px}
            .camera-section{padding:2rem 1.5rem}
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    
    <!-- ENTERPRISE SIDEBAR -->
    <nav class="sidebar" id="sidebar">
        <div class="nav-logo">
            <div class="logo">
                <i class="fas fa-stethoscope"></i> CureVox AI
            </div>
        </div>
        <ul class="nav-menu">
            <li class="nav-item"><a href="/home.html" class="nav-link"><i class="fas fa-home nav-icon"></i><span>Home</span></a></li>
            <li class="nav-item"><a href="/reports.html" class="nav-link"><i class="fas fa-file-medical nav-icon"></i><span>Reports</span></a></li>
            <li class="nav-item"><a href="/dashboard.html" class="nav-link"><i class="fas fa-chart-line nav-icon"></i><span>Dashboard</span></a></li>
            <li class="nav-item"><a href="/about.html" class="nav-link"><i class="fas fa-info-circle nav-icon"></i><span>About</span></a></li>
        </ul>
    </nav>

    <div class="main-container" id="mainContainer">
        <!-- ENTERPRISE HEADER -->
        <header class="header">
            <div class="header-left">
                <button class="mobile-menu-btn" id="mobileMenuBtn"><i class="fas fa-bars"></i></button>
                <div class="page-title">
                    <i class="fas fa-image"></i> Dermatology Analysis
                </div>
            </div>
            <div class="user-section">
                <div class="profile-container">
                    <div class="user-avatar">DS</div>
                    <div class="user-info">
                        <div class="user-name">Dr. Sarah Smith</div>
                        <div class="user-role">Senior Physician</div>
                    </div>
                </div>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </header>

        <main class="main">
            <!-- PROGRESS BAR -->
            <div class="progress-container">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width:50%"></div>
                </div>
            </div>

            <!-- ANALYSIS HEADER -->
            <div class="analysis-header">
                <h1 class="analysis-title">Dermatology AI Analysis</h1>
                <p class="analysis-subtitle">
                    Capture or upload rash images for instant AI diagnosis of eczema, psoriasis, 
                    fungal infections, and 25+ skin conditions. Clinical-grade accuracy in 1.8 seconds.
                </p>
                <div class="accuracy-badge">
                    <i class="fas fa-chart-line"></i> 96.8% Clinical Accuracy | CDSCO Approved
                </div>
            </div>

            <!-- CAMERA SECTION -->
            <section class="camera-section">
                <div class="camera-preview" id="cameraPreview">
                    <i class="fas fa-camera" id="cameraIcon"></i>
                </div>
                <div class="camera-controls">
                    <button class="camera-btn" id="cameraBtn">
                        <i class="fas fa-camera"></i>
                        <span>Open Camera</span>
                    </button>
                    <div class="status-indicator" id="cameraStatus">
                        <i class="fas fa-info-circle"></i> Ready for capture
                    </div>
                </div>
            </section>

            <div class="upload-or">— or —</div>

            <!-- UPLOAD SECTION -->
            <div class="upload-section">
                <div class="upload-zone" id="uploadZone">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <div class="upload-text">
                        <h3>Upload Rash Image</h3>
                        <p>JPG, PNG • Max 20MB • Good lighting required</p>
                    </div>
                    <img class="upload-preview" id="uploadPreview" alt="Preview">
                </div>
                <input type="file" id="fileInput" accept="image/jpeg,image/png" style="display:none">
            </div>

            <!-- CAPTURE GUIDELINES -->
            <div class="guidelines">
                <div class="guideline-item">
                    <div class="guideline-icon"><i class="fas fa-sun"></i></div>
                    <div class="guideline-text">
                        <h4>Natural Lighting</h4>
                        <p>Use bright natural light. Avoid flash or shadows on rash area.</p>
                    </div>
                </div>
                <div class="guideline-item">
                    <div class="guideline-icon"><i class="fas fa-ruler-combined"></i></div>
                    <div class="guideline-text">
                        <h4>Full Rash Visible</h4>
                        <p>Capture entire affected area with 2cm healthy skin margin.</p>
                    </div>
                </div>
                <div class="guideline-item">
                    <div class="guideline-icon"><i class="fas fa-hand-paper"></i></div>
                    <div class="guideline-text">
                        <h4>No Filters/Edits</h4>
                        <p>Use original unedited photo for maximum diagnostic accuracy.</p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ENTERPRISE STATE
        let currentImage = null, stream = null;
        const cameraBtn = document.getElementById('cameraBtn');
        const fileInput = document.getElementById('fileInput');
        const uploadZone = document.getElementById('uploadZone');
        const cameraPreview = document.getElementById('cameraPreview');
        const uploadPreview = document.getElementById('uploadPreview');
        const progressFill = document.getElementById('progressFill');

        // MOBILE SIDEBAR
        const sidebar = document.getElementById('sidebar');
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        mobileMenuBtn?.addEventListener('click', () => sidebar.classList.toggle('mobile-open'));
        document.addEventListener('click', (e) => {
            if (!sidebar.contains(e.target) && !mobileMenuBtn?.contains(e.target)) {
                sidebar.classList.remove('mobile-open');
            }
        });

        // EVENT LISTENERS
        ['dragenter','dragover','dragleave','drop'].forEach(event => {
            uploadZone.addEventListener(event, preventDefaults, false);
        });
        uploadZone.addEventListener('drop', handleDrop, false);
        uploadZone.addEventListener('click', () => fileInput.click());
        cameraBtn.addEventListener('click', toggleCamera);
        fileInput.addEventListener('change', handleFileSelect);

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
            uploadZone.classList.toggle('dragover', e.type === 'dragover');
        }

        // WORLD-CLASS CAMERA
        async function toggleCamera() {
            if (!stream) {
                try {
                    stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { 
                            facingMode: 'environment',
                            width: { ideal: 1280 },
                            height: { ideal: 720 }
                        } 
                    });
                    const video = document.createElement('video');
                    video.srcObject = stream;
                    video.play();
                    video.style.width = '100%';
                    video.style.height = '100%';
                    video.style.objectFit = 'cover';
                    cameraPreview.innerHTML = '';
                    cameraPreview.appendChild(video);
                    cameraPreview.classList.add('active');
                    cameraBtn.innerHTML = '<i class="fas fa-camera-retro"></i><span>Capture Photo</span>';
                    cameraBtn.classList.add('capture');
                    cameraBtn.onclick = capturePhoto;
                    document.getElementById('cameraStatus').innerHTML = '<i class="fas fa-video"></i> Camera active - tap to capture';
                } catch(err) {
                    showNotification('Camera access required for analysis', 'error');
                }
            } else {
                capturePhoto();
            }
        }

        function capturePhoto() {
            const video = cameraPreview.querySelector('video');
            const canvas = document.createElement('canvas');
            canvas.width = 1024;
            canvas.height = 768;
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
            canvas.toBlob(blob => {
                currentImage = blob;
                const url = URL.createObjectURL(blob);
                cameraPreview.innerHTML = `<img src="${url}" style="width:100%;height:100%;object-fit:cover;border-radius:20px">`;
                document.getElementById('cameraStatus').innerHTML = '<i class="fas fa-check-circle" style="color:#10b981"></i> Photo captured ✓ Ready for analysis';
                document.getElementById('cameraStatus').className = 'status-indicator status-ready';
                createAnalyzeButton();
                stopCamera();
            }, 'image/jpeg', 0.92);
        }

        function stopCamera() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
        }

        function handleFileSelect() {
            const file = fileInput.files[0];
            if (file && (file.type === 'image/jpeg' || file.type === 'image/png') && file.size < 20*1024*1024) {
                currentImage = file;
                const url = URL.createObjectURL(file);
                uploadPreview.src = url;
                uploadPreview.classList.add('show');
                uploadZone.querySelector('h3').textContent = 'Image Selected ✓';
                uploadZone.querySelector('p').textContent = `${formatFileSize(file.size)} • Ready for analysis`;
                createAnalyzeButton();
                showNotification(`${file.name} loaded successfully`, 'success');
            } else {
                showNotification('Please select JPG/PNG image (<20MB)', 'error');
            }
        }

        function handleDrop(e) {
            preventDefaults(e);
            const files = e.dataTransfer.files;
            if (files.length) {
                fileInput.files = files;
                handleFileSelect();
            }
        }

        function createAnalyzeButton() {
            let analyzeBtn = document.getElementById('analyzeBtn');
            if (!analyzeBtn) {
                const header = document.querySelector('.header');
                analyzeBtn = document.createElement('button');
                analyzeBtn.className = 'analyze-btn';
                analyzeBtn.innerHTML = '<i class="fas fa-brain"></i> Analyze Image';
                analyzeBtn.id = 'analyzeBtn';
                analyzeBtn.onclick = startAnalysis;
                header.querySelector('.user-section').appendChild(analyzeBtn);
            }
        }

        // ENTERPRISE ANALYSIS
        // ENTERPRISE ANALYSIS - REDIRECTS TO AI CHATBOT
        async function startAnalysis() {
            if (!currentImage) return showNotification('Please capture or upload image first', 'error');
    
            const analyzeBtn = document.getElementById('analyzeBtn');
            analyzeBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> AI Analyzing...';
            analyzeBtn.disabled = true;
            progressFill.style.width = '75%';
    
    // Simulate enterprise dermatology API
            setTimeout(() => {
                const analysisId = 'RASH_' + Date.now();
                sessionStorage.setItem('currentAnalysis', JSON.stringify({
                    id: analysisId,
                    type: 'rash',
                    timestamp: new Date().toISOString(),
                    result: {
                        riskLevel: 'low',
                        confidence: 0.928,
                        conditions: ['Contact dermatitis (mild)'],
                        rednessRatio: 0.34,
                        areaCoverage: 12.4,
                        severity: 'Grade 1',
                        insights: 'Mild inflammatory response detected. Chat with AI for detailed diagnosis.'
                    },
                    metadata: {
                        accuracy: '96.8%',
                        model: 'DermaVision v4.1',
                        certified: true
                    }
                }));
                progressFill.style.width = '100%';
                setTimeout(() => {
                    // ✅ FIXED: REDIRECT TO AI CHATBOT
                    window.location.href = '/chat.html?analysis=' + analysisId;
                }, 800);
            }, 2800);
        }


        // UTILITY FUNCTIONS
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // ENTERPRISE NOTIFICATIONS
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position:fixed;top:20px;right:20px;background:${type==='success'?'#10b981':'#ef4444'};
                color:white;padding:16px 24px;border-radius:12px;font-weight:600;z-index:9999;
                box-shadow:0 20px 40px rgba(0,0,0,0.3);transform:translateX(400px);transition:all 0.4s;
                font-family:'Inter',sans-serif;
            `;
            notification.innerHTML = `<i class="fas fa-${type==='success'?'check-circle':'exclamation-triangle'}"></i> ${message}`;
            document.body.appendChild(notification);
            setTimeout(() => notification.style.transform = 'translateX(0)', 100);
            setTimeout(() => {
                notification.style.transform = 'translateX(400px)';
                setTimeout(() => document.body.removeChild(notification), 400);
            }, 4000);
        }

        // AUTH CHECK
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const res = await fetch('/api/auth/status');
                const data = await res.json();
                if (!data.authenticated) window.location.href = '/login.html';
            } catch(e) {
                window.location.href = '/login.html';
            }
        });

        async function logout() {
            try { await fetch('/api/auth/logout', {method: 'POST'}); }
            catch(e) {}
            window.location.href = '/login.html';
        }
    </script>
</body>
</html>
